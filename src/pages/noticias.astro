---
import Base from "@/layouts/Base.astro";

const TITLE = "Noticias de tecnología (informativas)";

const now = new Date();
const yyyy = now.getFullYear();
const mm   = String(now.getMonth()+1).padStart(2,'0');
const dd   = String(now.getDate()).padStart(2,'0');

let items = [];
try {
  const mod = await import(`@/data/news/${yyyy}/${mm}/${dd}/index.json`);
  items = mod.default?.items || mod.items || [];
} catch {}

const card = (it)=>`
  <a class="card" href="/producto/${it.slug}">
    <img src="${it.hero || '/placeholder.jpg'}" alt="${it.title}" loading="lazy" />
    <div class="p">
      <span class="badge">${it.niche || 'news'}</span>
      <h3>${it.title}</h3>
      <small>score ${it.score || 1}</small>
    </div>
  </a>
`;
---

<Base title={`Teknovashop · ${TITLE}`} description="Selección de noticias de tecnología en español.">
  <h1>${TITLE}</h1>
  <div class="grid">
    {items.length ? items.map(it => Astro.raw(card(it))) : <p>No hay noticias hoy todavía.</p>}
  </div>

  <style>
    .grid{ display:grid; gap:1rem; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); margin:1rem 0 2rem }
    .card{ border:1px solid #e5e7eb; background:#fff; border-radius:14px; overflow:hidden; color:inherit; text-decoration:none }
    .card img{ width:100%; height:150px; object-fit:cover; display:block }
    .card .p{ padding:.75rem }
    .badge{ background:#e6f7fb; color:#04748b; padding:.2rem .5rem; border-radius:999px; font-size:.75rem; font-weight:700 }
    h3{ margin:.4rem 0 .3rem; font-size:1rem; line-height:1.3 }
    small{ color:#6b7280 }
  </style>
</Base>
