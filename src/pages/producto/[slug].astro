---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const { slug } = Astro.params;

// Buscamos la entrada en la colección "trends"
const entries = await getCollection('trends');
const post = entries.find((e) => e.slug === slug);

if (!post) {
  throw new Error('Producto no encontrado');
}

const { Content } = await post.render();
---

<Base title={`${post.data.title} — Teknovashop`}>
  <h1>{post.data.title}</h1>

  {post.data.hero && (
    <img class="hero" src={post.data.hero} alt={post.data.title} loading="lazy"
         onerror={`this.onerror=null;this.src='/placeholder.jpg';`} />
  )}

  <p class="meta">
    <span class="badge">{post.data.niche}</span> · score {post.data.score}
  </p>

  <div class="prose">
    <Content />
  </div>
</Base>

<style>
.hero{
  width:100%;
  max-width:980px;
  aspect-ratio:16/9;
  object-fit:cover;
  border-radius:16px;
  background:#f3f5f7;
  display:block;
}
.meta{ color:#5e6; margin:.75rem 0 1rem; }
.badge{
  display:inline-block;
  font-size:.75rem;
  padding:.2rem .5rem;
  color:#155;
  background:#e6fffc;
  border-radius:999px;
}
.prose :where(p,ul,ol){ line-height:1.6; }
.prose ul{ padding-left:1.2rem; }
.prose a{ color:#0aa; text-decoration:underline; }
</style>
