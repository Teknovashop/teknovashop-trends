---
import Base from '../../layouts/Base.astro';

// Recolecta todos los .md generados en src/content/trends/**/*
export async function getStaticPaths() {
  const posts = await Astro.glob('../../content/trends/**/*.md');

  // Necesitamos que cada MD tenga frontmatter.slug (lo generamos en el script)
  return posts
    .filter((p) => p?.frontmatter?.slug)
    .map((post) => ({
      params: { slug: post.frontmatter.slug },
      props: { post }
    }));
}

const { post } = Astro.props;
const fm = post.frontmatter || {};
const { Content } = await post.render();
---

<Base title={`${fm.title || 'Producto'} — Teknovashop`}>
  <article class="prose">
    <h1>{fm.title}</h1>
    {fm.hero ? (
      <img src={fm.hero} alt={fm.title} class="hero" loading="lazy" />
    ) : null}

    <p class="small">
      {fm.niche ? (<><span class="badge">{fm.niche}</span> · </>) : null}
      {typeof fm.score !== 'undefined' ? <>score {fm.score}</> : null}
    </p>

    <Content />
  </article>

  <style>
    .prose { max-width: 60rem; margin: 0 auto; padding: 1rem; }
    .hero { width: 100%; height: auto; border-radius: .5rem; margin: .5rem 0 1rem; }
    .badge { background: #eef; padding: .2rem .5rem; border-radius: .4rem; }
    .small { color: #666; }
  </style>
</Base>
